{
  "policy": {
    "name": "invalid-ip-address-login-detected",
    "resource": "account",
    "description": "Notifies on invalid external IP console logins\n",
    "mode": {
      "role": "arn:aws:iam::529219089249:role/cloud-sheriff-lambda-execution-role",
      "type": "cloudtrail",
      "events": [
        "ConsoleLogin"
      ],
      "tags": {
        "custodian-info": "mode=cloudtrail:version=0.8.45.0"
      }
    },
    "filters": [
      {
        "not": [
          {
            "type": "event",
            "key": "detail.sourceIPAddress",
            "value": "^70\\.114\\.248\\.155$",
            "op": "regex"
          }
        ]
      }
    ],
    "actions": [
      {
        "type": "post-finding",
        "compliance_status": "FAILED",
        "criticality": 50,
        "description": "Console login from an unknown IP address.\n",
        "recommendation": "Find the typical IP addresses of your users that log into the console and add them to this policy.",
        "severity_normalized": 50,
        "title": "invalid-ip-address-login-detected",
        "types": [
          "TTPs/Initial Access"
        ],
        "confidence": 100
      }
    ]
  },
  "version": "0.8.45.0",
  "execution": {
    "id": "5bf70b80-efbb-4868-b304-9c278f0b1ece",
    "start": 1572389003.344861,
    "end_time": 1572389007.8695738,
    "duration": 4.524712800979614
  },
  "config": {
    "region": "us-east-1",
    "regions": [],
    "cache": "~/.cache/cloud-custodian.cache",
    "profile": null,
    "account_id": null,
    "assume_role": null,
    "external_id": null,
    "log_group": null,
    "tracer": null,
    "metrics_enabled": null,
    "metrics": null,
    "output_dir": "out",
    "cache_period": 15,
    "dryrun": false,
    "authorization_file": null,
    "subparser": "run",
    "config": null,
    "configs": [
      "account.yaml"
    ],
    "policy_filter": null,
    "resource_type": null,
    "verbose": null,
    "quiet": null,
    "debug": false,
    "skip_validation": false,
    "command": "c7n.commands.run",
    "vars": null
  },
  "sys-stats": {},
  "api-stats": {
    "sts.AssumeRole": 2,
    "lambda.GetFunction": 1,
    "lambda.UpdateFunctionCode": 1,
    "events.DescribeRule": 1,
    "lambda.AddPermission": 1,
    "events.ListTargetsByRule": 1
  },
  "metrics": []
}